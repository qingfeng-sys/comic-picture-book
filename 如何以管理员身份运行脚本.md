# 如何以管理员身份运行 PowerShell 脚本

## 方法 1: 通过开始菜单（推荐）

### 步骤：
1. **打开开始菜单**
   - 按 `Win` 键或点击左下角 Windows 图标

2. **搜索 PowerShell**
   - 在搜索框输入 `PowerShell` 或 `powershell`

3. **右键点击 "Windows PowerShell"**
   - 不要直接点击！
   - 在搜索结果中找到 "Windows PowerShell"
   - **右键点击**它

4. **选择 "以管理员身份运行"**
   - 在右键菜单中点击 "以管理员身份运行"
   - 会弹出用户账户控制（UAC）提示，点击 "是"

5. **导航到项目目录**
   ```powershell
   cd d:\Projects\comic-picture-book
   ```

6. **运行脚本**
   ```powershell
   .\fix-and-start.ps1
   ```

## 方法 2: 通过文件资源管理器

### 步骤：
1. **打开文件资源管理器**
   - 按 `Win + E` 或点击文件夹图标

2. **导航到项目目录**
   - 进入 `d:\Projects\comic-picture-book`

3. **找到脚本文件**
   - 找到 `fix-and-start.ps1` 文件

4. **右键点击脚本文件**
   - **右键点击** `fix-and-start.ps1`

5. **选择 "使用 PowerShell 运行"**
   - 在右键菜单中找到 "使用 PowerShell 运行"
   - 如果提示需要权限，点击 "是"

   **注意：** 如果右键菜单中没有 "使用 PowerShell 运行"，使用方法 1。

## 方法 3: 通过命令提示符（CMD）

### 步骤：
1. **以管理员身份打开 CMD**
   - 按 `Win + X`
   - 选择 "Windows PowerShell (管理员)" 或 "命令提示符 (管理员)"
   - 或搜索 "cmd"，右键选择 "以管理员身份运行"

2. **导航到项目目录**
   ```cmd
   cd /d d:\Projects\comic-picture-book
   ```

3. **运行 PowerShell 脚本**
   ```cmd
   powershell -ExecutionPolicy Bypass -File .\fix-and-start.ps1
   ```

## 方法 4: 直接创建快捷方式（最简单）

### 步骤：
1. **在项目目录中，右键点击 `fix-and-start.ps1`**
   - 选择 "创建快捷方式"

2. **右键点击新创建的快捷方式**
   - 选择 "属性"

3. **在 "快捷方式" 标签页**
   - 点击 "高级" 按钮
   - 勾选 "用管理员身份运行"
   - 点击 "确定"

4. **以后直接双击快捷方式即可**

## 如果遇到执行策略错误

如果运行时提示 "无法加载文件，因为在此系统上禁止运行脚本"，请执行：

```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

然后输入 `Y` 确认。

## 验证是否以管理员身份运行

在 PowerShell 中运行以下命令检查：

```powershell
([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)
```

如果返回 `True`，说明已以管理员身份运行。

## 快速操作步骤总结

**最简单的方法：**

1. 按 `Win` 键
2. 输入 `powershell`
3. 右键点击 "Windows PowerShell"
4. 选择 "以管理员身份运行"
5. 点击 "是"（UAC 提示）
6. 输入：
   ```powershell
   cd d:\Projects\comic-picture-book
   .\fix-and-start.ps1
   ```

## 注意事项

- ⚠️ 以管理员身份运行会弹出 UAC（用户账户控制）提示，这是正常的安全机制
- ✅ 点击 "是" 允许运行
- 🔒 只在需要时使用管理员权限，运行完成后可以关闭窗口
- 📝 如果不想每次都输入路径，可以先 `cd` 到项目目录



