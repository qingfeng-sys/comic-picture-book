# 漫画绘本创作应用

一个AI驱动漫画绘本创作工具，支持故事脚本生成和自动生成卡通风格漫画绘本。目前定位为本地/内网演示项目，尚未接入真实后端鉴权或生产级存储。

## ✨ 功能特性

### 📝 脚本生成
- AI智能生成故事大纲/剧本/分镜（基于阿里云百炼 DashScope 文本生成）
- 对话式交互，逐步完善脚本内容
- 支持脚本编辑和保存

### 🎨 漫画生成
- 自动生成卡通风格漫画绘本
- 支持结构化分镜数据
- 自动切分长脚本（10页为单位）
- 图片自动保存和过期清理

### 👤 用户系统（演示版）
- 基于 localStorage 的本地注册/登录（无后端鉴权，不适合生产）
- 作品管理和查看
- 支持批量下载（ZIP打包）

### 📱 响应式设计
- 支持桌面端和移动端
- 流畅的SPA体验

## 🚀 快速开始

> 运行要求：Node.js 18+，自行提供有效的 DashScope / 七牛云 API Key（部署前务必用自己的密钥覆盖）。

### 安装依赖
```bash
npm install
```

### 配置环境变量

创建 `.env.local` 文件：
```env
# DashScope（必需）- 用于故事大纲/剧本/分镜生成
DASHSCOPE_API_KEY=your_dashscope_api_key_here

# 七牛云API（必需）- 用于图像生成
QINIU_API_KEY=your_qiniu_api_key_here
# 可选：启用调用前密钥校验
# ENABLE_API_KEY_VERIFICATION=true

# （可选）DashScope 文本生成超时（毫秒，72B/80B 模型建议适当加大）
# DASHSCOPE_SCRIPT_TIMEOUT_MS=90000
# DASHSCOPE_STORYBOARD_TIMEOUT_MS=120000
```

### 运行开发服务器
```bash
npm run dev
```

访问 `http://localhost:3000`

## ⚙️ 当前状态与限制

- 本地/内网演示：用户与作品数据均存于浏览器 localStorage，未接入真实后端或数据库。
- 图片存储在本地 `public/comic-assets/`，7天后通过 `/api/comic/cleanup` 清理；生产环境需替换为对象存储/CDN。
- 密钥安全：`lib/qiniu.ts` 内有开发环境回退密钥，仅供本地调试；部署前必须通过环境变量提供自己的密钥并停用回退。
- 尚未提供生产鉴权、限流、监控与部署脚本，发布前需补齐。

## 📖 使用指南

### 生成故事脚本
1. 登录后，选择"脚本生成"
2. 输入故事描述或主题
3. 与AI对话，完善脚本内容
4. 确认并保存脚本

### 生成漫画绘本
1. 选择"绘本生成"
2. 选择已保存的脚本或导入外部脚本
3. 系统自动切分长脚本（如需要）
4. 选择脚本片段，点击生成
5. 等待绘本创建完成，可查看和下载

## 🛠️ 技术栈

- **框架**: Next.js 16 + React 18
- **语言**: TypeScript 5.0
- **样式**: Tailwind CSS 3.3
- **AI服务**: DashScope 文本生成（故事大纲/剧本/分镜）、七牛云API/通义万相（图像生成，默认模型 gemini-2.5-flash-image）

## 📚 文档

- **[技术框架文档](./技术框架文档.md)** - 详细的技术架构、API文档、开发规范等

## ⚠️ 注意事项

- 需要配置API密钥才能使用完整功能
- 建议在网络良好的环境下使用
- 生成的图片会在7天后自动清理

## 📄 许可证

Private Project

